var apiKey,clientId,scopes,init,pageToken,sheetFiles,listFiles,loadFile,handle;apiKey="AIzaSyD3emlU63t6e_0n9Zj9lFCl-Rwod0OMTqY",clientId="1003996266757-4gv30no8ije0sd8d8qsd709dluav0676.apps.googleusercontent.com",scopes=["profile","https://www.googleapis.com/auth/drive.metadata.readonly","https://www.googleapis.com/auth/spreadsheets.readonly"].join(" "),init=function(){return gapi.client.setApiKey(apiKey),gapi.auth2.init({client_id:clientId,scope:scopes})},pageToken=null,sheetFiles=[],listFiles=function(e){var t,i;return t={pageSize:20,fields:"nextPageToken, files(id, name)",q:"mimeType='application/vnd.google-apps.spreadsheet'"},e&&(t.pageToken=e),i=gapi.client.drive.files.list(t),i.execute(function(e){var t;return pageToken=e.nextPageToken,e.files?(t=document.getElementById("sheet-list"),e.files.map(function(e){var i;return i=document.createElement("div"),i.innerHTML=e.name,i.sheetId=e.id,t.appendChild(i)}),sheetFiles.push.apply(sheetFiles,e.files)):void 0})},loadFile=function(e){return isLoading(!0),gapi.client.load("https://sheets.googleapis.com/$discovery/rest?version=v4").then(function(){return gapi.client.sheets.spreadsheets.values.get({spreadsheetId:e,range:"A:ZZ"})}).then(function(e){return sheet(e)})},handle=function(){return gapi.auth2.getAuthInstance().signIn().then(function(){var e;return gapi.client.load("drive","v3",listFiles),e=document.getElementById("sheet-list"),e.style.display="block",e.addEventListener("click",function(t){var i;return e.style.display="none",(i=t.target.sheetId)?loadFile(i):void 0})})},gapi.load("client:auth2",init);